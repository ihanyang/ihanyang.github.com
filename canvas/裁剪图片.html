
<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<title>路再长，也长不过我35码半的脚步</title>
<link rel="shortcut icon" href="../images/favicon.ico" />
<style>
body, div {
	padding: 0;
	margin: 0;
	font-family: "Microsoft YaHei";
}
.wrap {
	width: 500px;
	height: 700px;
	margin: 5% 0 0 20%;
	position: relative;
	border: 2px solid #BB44C2;
}
.move {
	width: 150px;
	height: 150px;
	position: absolute;
	top: 0;
	cursor: move;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
	background-color: rgba(255, 255, 255, 0.3);
}
.show {
	position: absolute;
	top: 11%;
	right: 25%;
	background-color: green;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
}
</style>
<script>
window.onload = function () {
	var c = document.querySelectorAll("canvas")[0],
		cc = c.getContext("2d"),
		show = document.querySelectorAll("canvas")[1].getContext("2d"),
		move = document.querySelector(".move"),
		getStyle = function (obj, name) {
			if (parseInt(obj.style.name)) {
				return parseInt(obj.style.name);
			} else {
				if (obj.currentStyle) {
					return parseInt(obj.currentStyle[name]);
				} else {
					return parseInt(getComputedStyle(obj, false)[name]);
				}
			}
		},
		imgData,
		x,
		y,
		l,
		t,
		img = new Image();
	img.src = "nv.jpg"; //"http://www.iyi8.com/uploadfile/2014/0422/20140422011447558.jpg";
	cc.drawImage(img, 0, 0);

	move.onmousedown = function (e) {
		x = e.clientX - getStyle(this, "left");
		y = e.clientY - getStyle(this, "top");
		document.onmousemove = function (e) {
			t = e.clientY - y;
			l = e.clientX - x;
			if (t < 0) {
				t = 0;
			} else if (t > c.height - 150) {
				t = c.height - 150;
			}
			if (l < 0) {
				l = 0;
			} else if (l > c.width - 150) {
				l = c.width - 150;
			}
			move.style.top = t + "px";
			move.style.left = l + "px";
			imgData = cc.getImageData(l, t, 150, 150);
			show.putImageData(imgData, 0, 0);
		};
	};
	document.onmouseup = function (e) {
		document.onmousemove = null;
	};

};
</script>
</head>

<body>
	<div class="wrap">
		<canvas width="500" height="700">悠哉悠哉，辗转反侧</canvas>
		<div class="move"></div>
	</div>
	<canvas class="show" width="150" height="150"></canvas>
</body>
</html>